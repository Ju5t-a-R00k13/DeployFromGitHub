<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" type="image/png" sizes="16x16" href="img/icon16x16.png">
    <title>My Little Shop</title>
    <link href="css/lib/bootstrap/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <!-- script -->
    <script src="js/jquery/jquery.min.js"></script>
    <script src="js/variable.js"></script>
    <script src="js/function.js"></script> 
    <script src="https://www.gstatic.com/firebasejs/4.13.0/firebase.js"></script>
    <script src="js/init.js"></script>

</head>
<body>
    <div class="main-wrapper">
        <div class="header">
            <nav class="navbar top-navbar navbar-expand-md navbar-light">
                <!-- Logo -->
                <div class="navbar-header">
                    <a class="navbar-brand" href="index.html">
                        <!-- Logo icon -->
                        <b><img src="img/logo.png" alt="homepage" class="dark-logo" /></b>
                        <!-- Logo text -->
                        <span>My Little Shop</span>
                    </a>
                </div>
       
               
            </nav>
        </div>
         <div class="left-sidebar">
             
        </div>
        <div class="page-wrapper">
          <div class="container-fluid ">
            <div class="row" id="content">
                <div class="col-lg-12">
                    <div class="card">
                      <div class="card-title form-title">
                        <h4>Input Product Data</h4>
                      </div>
                      <div class="card-body">
                        <div class="basic-form">
                          <form>
                            <div class="form-group col-lg-12">
                              <p class="text-muted m-b-15 f-s-12">Product Code</p>
                              <input type="text" class="form-control input-default" id="pCode" placeholder="">
                              </div>
                              <div class="form-group col-lg-12">
                                <p class="text-muted m-b-15 f-s-12">Price</p>
                                <input type="text" class="form-control input-default " id="pPrice" placeholder="">
                                </div>
                                <div class="form-group col-lg-12">
                                  <p class="text-muted m-b-15 f-s-12">Stock</p>
                                  <input type="text" class="form-control input-default " id="pStock" placeholder="">
                                  </div>
                                  <button class="btn btn-success" type="button" onclick="import_product()">Import</button>
                                </form>
                              </div>
                            </div>
                          </div>
                        </div>
            </div>
        </div>
        </div>
    </div>
</body>
<script src="js/app.js"></script>
<script>

  function import_product(){
    var code= document.getElementById('pCode').value;
    var price= document.getElementById('pPrice').value;
    var stock= document.getElementById('pStock').value;
    var shop = 1;  
    var i = 0;
    var data = {
      product_price: price,
      stock: stock,
      store_id: shop
    }
     
    var updates = {};
    var databaseRef = firebase.database().ref('product/');
    var exist = false;

    databaseRef.once('value', function(snapshot) {
      snapshot.forEach(function(childSnapshot) {
        var childKey = childSnapshot.key;
        if(code == childKey){
          exist = true;
        }
      });

      if(exist){
        alert('Product code exist!');
      }else{
        updates['/product/' + code] = data;
        firebase.database().ref().update(updates);
        alert('The user is created successfully!');
        reload_page();
      }      
    });


  }

  function reload_page(){
     window.location.reload();
  }
</script>

</html>